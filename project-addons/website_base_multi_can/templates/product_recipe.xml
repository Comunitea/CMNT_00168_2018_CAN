<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Page template for displaying recipes -->
    <template id="can_recipes_list_template" name="Recipes">
        <t t-call="website.layout">
            <t t-set="additional_title">Product recipe list</t>
            <div id="wrap">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <h1 class="text-center">Recipes list</h1>
                        </div>
                    </div>
                    <div class="row wp-recipe_list mt32 mb32">
                        <t t-if="recipe_list">
                            <t t-foreach="recipe_list" t-as="res">
                                <div class="col-md-3 mb32 one_recipe">
                                    <a t-att-href="'/recipe/%s' % res.slug" t-att-title="res.title">
                                        <div class="recipe_image">
                                            <img t-attf-src="/web/image/product.recipe/{{res.id}}/image/"
                                                 t-att-alt="res.title" class="img img-responsive"/>
                                        </div>
                                        <div class="recipe_name">
                                            <h4 t-esc="res.title"/>
                                        </div>
                                        <div class="recipe_description" t-if="res.description_short">
                                            <p t-esc="res.description_short"/>
                                        </div>
                                    </a>
                                </div>
                            </t>
                        </t>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Page template for displaying one recipe -->
    <template id="can_recipe_template" name="Recipe">
        <t t-set="main_object" t-value="recipe"/>
        <t t-call="website.layout">
            <t t-set="additional_title" t-value="recipe.title"/>
            <div id="wrap">
                <section class="container mt8">
                    <div class="row">
                        <div class="col-sm-7">
                            <t t-set="image_ids" t-value="recipe.recipe_image_ids"/>
                            <div id="o-carousel-recipe" class="carousel slide recipe-carousel" data-ride="carousel" data-interval="0">
                                <div class="carousel-outer">
                                    <div class="carousel-inner">
                                        <div class="item active">
                                            <img t-att-alt="recipe.title" t-att-title="recipe.title"
                                                 t-attf-src="/web/image/product.recipe/{{recipe.id}}/image/"/>
                                        </div>
                                        <t t-if="len(image_ids)" t-foreach="image_ids" t-as="image">
                                            <div class="item">
                                                <img t-att-alt="image.name" t-att-title="image.name"
                                                     t-attf-src="/web/image/recipe.image/{{image.id}}/image/"/>
                                            </div>
                                        </t>
                                        <div class="item" t-if="recipe.video">
                                            <iframe width="100%" height="480" t-att-src="recipe.video"
                                                    frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="true"/>
                                        </div>
                                    </div>
                                    <t t-if="len(image_ids) or recipe.video">
                                        <a class="carousel-control left" href="#o-carousel-recipe" role="button" data-slide="prev" >
                                            <span class="fa fa-chevron-left" aria-hidden="true"/>
                                            <span class="sr-only">Previous</span>
                                        </a>
                                        <a class="carousel-control right" href="#o-carousel-recipe" role="button" data-slide="next">
                                            <span class="fa fa-chevron-right" aria-hidden="true"/>
                                            <span class="sr-only">Next</span>
                                        </a>
                                    </t>
                                </div>
                                <ol class="carousel-indicators" t-if="len(image_ids) or recipe.video">
<!--                                    <li data-target="#o-carousel-recipe" data-slide-to="0" class="active"/>-->
<!--                                    <t t-if="len(image_ids)" t-foreach="image_ids" t-as="image">-->
<!--                                        <li data-target="#o-carousel-recipe" t-att-data-slide-to="image_index + 1"/>-->
<!--                                    </t>-->
                                    <li t-if="recipe.video" data-target="#o-carousel-recipe" t-att-data-slide-to="len(image_ids) + 1"/>


                                    <t t-if="len(image_ids)" t-foreach="image_ids" t-as="pimg">
                                        <li data-target="#o-carousel-recipe" t-att-data-slide-to="pimg_index + 1">
                                            <img class="img img-responsive" t-attf-src="/website/image/recipe.image/{{pimg.id}}/image/90x90" t-att-alt="pimg.name"/>
                                        </li>
                                    </t>
                                  </ol>
                            </div>
                        </div>
                        <div class="col-sm-5 col-lg-4 col-lg-offset-1">
                            <h1 t-field="recipe.title"/>
                            <h4 t-field="recipe.subtitle"/>
                            <hr t-if="recipe.description_short"/>
                            <p class="text-muted" t-field="recipe.description_short" t-if="recipe.description_short"/>
                            <div class="mt16" t-if="len(recipe.product_ids)">
                                <hr/>
                                <h4>Products</h4>
                                <div class="row">
                                    <t t-foreach="recipe.product_ids" t-as="product">
                                        <div class="wp-related-product col-md-6 mt16">
                                            <a t-attf-href="/product/{{product.slug}}">
                                                <div class="related-product">
                                                    <img t-att-alt="product.name" t-att-title="product.name" class="img-responsive shadow o_alternative_product"
                                                         t-attf-src="/website/image/product.template/{{product.id}}/image_medium/"/>
                                                    <h5 t-field="product.name" class="o_text_overflow"/>
                                                </div>
                                            </a>
                                        </div>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="mt16 mb16">
                    <div class="container">
                        <div class="row">
                            <h4>Description</h4>
                            <div class="col-md-12" t-field="recipe.description"/>
                        </div>
                    </div>
                </section>
            </div>
        </t>
    </template>

</odoo>